var b=Object.defineProperty;var $=(e,t,s)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var o=(e,t,s)=>$(e,typeof t!="symbol"?t+"":t,s);import{b as d,i as u,$ as c,d as f,h as k,c as r}from"./dom.DntxtiBs.js";function h(e,t){if(k(e,"l-loading"))return;let s;if(t.fullscreen&&c("#l-loading")!=null)return;const l=["l-loading"];(t.mask===1||t.mask===2&&t.shape==="circle")&&(s=r("div",{class:"l-loading-mask",style:{"background-color":t.background,"--l-loading-zindex":t.zindex}}),e.appendChild(s));const n=r("div",{class:`l-loading-spinner l-loading--${t.shape}`,style:{"--l-loading-color":t.color}});if(t.shape==="bar"){const a=r("div",{class:"l-loading-progress"});n.appendChild(a)}else if(t.shape==="circle"){const a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("viewBox","0 0 50 50"),a.classList.add("circle");const i=document.createElementNS("http://www.w3.org/2000/svg","circle");if(i.classList.add("path"),i.setAttribute("cx","25"),i.setAttribute("cy","25"),i.setAttribute("r","23"),i.setAttribute("fill","none"),a.appendChild(i),n.appendChild(a),t.text){const m=r("p",{class:"l-loading-text",textContent:t.text});n.appendChild(m)}}e.appendChild(n),t.lock&&l.push("l-loading-lock"),t.fullscreen&&(l.push("l-loading-fullscreen"),n.id="l-loading"),e.classList.add(...l),requestAnimationFrame(()=>{s&&(s.style.opacity="1"),n.style.opacity="1",f(n,"l-loading-bar--start")})}function p(e,t){const s=e.tagName==="BODY"?"body":".l-loading",l=c(`${s} > .l-loading-mask`,e),n=c(`${s} > .l-loading-spinner`,e);if(!n)return;function a(){l&&l.remove(),n.remove();const i=["l-loading"];e.tagName==="BODY"&&i.push("l-loading-fullscreen","l-loading-lock"),e.classList.remove(...i)}n.addEventListener("transitionend",a,{once:!0}),requestAnimationFrame(()=>{l&&(l.style.opacity="0"),f(n,"l-loading-bar--finish"),n.style.opacity="0"})}class y{constructor(t){o(this,"el");o(this,"option");o(this,"isLoading",!1);this.option={fullscreen:!0,lock:!0,shape:"circle",text:"加载中……",background:"",color:"",mask:2,...t};const s=(t||{}).to;let l=null;s!=null&&(typeof s=="string"?l=document.querySelector(s):l=s),(l==null||this.option.fullscreen)&&(l=document.body),this.el=l,this.show()}show(){this.isLoading=!0,h(this.el,this.option)}hide(){this.isLoading=!1,p(this.el,this.option)}destroy(){this.hide(),this.el=void 0}}function g(e){const t=e.getAttribute("l-loading-text"),s=e.getAttribute("l-loading-lock");return{background:e.getAttribute("l-loading-background"),text:t?t==="0"||t==="false"?void 0:t:"加载中……",fullscreen:e.hasAttribute("l-loading-fullscreen"),lock:!(s==="0"||s==="false"),mask:Number(e.hasAttribute("l-loading-mask")||2),shape:e.getAttribute("l-loading-shape")||"circle",color:e.getAttribute("l-loading-color")}}const A={create(e){return new y(e)},init(e){const t=e?`[l-loading="${e}"]`:"[l-loading]",s=d(t);u(s,l=>{const n=g(l);h(n.fullscreen?document.body:l,n)})},close(e){const t=e?`[l-loading="${e}"]`:"[l-loading]",s=d(t);u(s,l=>{const n=g(l);p(n.fullscreen?document.body:l)})}};export{A as L};

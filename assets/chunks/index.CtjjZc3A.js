var m=Object.defineProperty;var b=(t,e,l)=>e in t?m(t,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[e]=l;var o=(t,e,l)=>b(t,typeof e!="symbol"?e+"":e,l);import{b as u,i as f,$ as d,d as g,h as $,c as r}from"./dom.DntxtiBs.js";function h(t,e){if($(t,"l-loading"))return;let l;if(e.fullscreen&&d("#l-loading")!=null)return;g(t,"l-loading"),(e.mask===1||e.mask===2&&e.shape==="circle")&&(l=r("div",{class:"l-loading-mask",style:{"background-color":e.background,"--l-loading-zindex":e.zindex}}),t.appendChild(l));const s=r("div",{class:`l-loading-spinner l-loading--${e.shape}`,style:{"--l-loading-color":e.color}});if(e.shape==="bar"){const n=r("div",{class:"l-loading-progress"});s.style.setProperty("top",`-${getComputedStyle(t).borderTopWidth}`),s.appendChild(n)}else if(e.shape==="circle"){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 50 50"),n.classList.add("circle");const a=document.createElementNS("http://www.w3.org/2000/svg","circle");if(a.classList.add("path"),a.setAttribute("cx","25"),a.setAttribute("cy","25"),a.setAttribute("r","23"),a.setAttribute("fill","none"),n.appendChild(a),s.appendChild(n),e.text){const i=r("p",{class:"l-loading-text",textContent:e.text});s.appendChild(i)}}if(t.appendChild(s),e.fullscreen){const n=["l-loading-fullscreen"];e.lock&&n.push("l-loading-lock"),t.classList.add(...n),s.id="l-loading"}requestAnimationFrame(()=>{l&&(l.style.opacity="1"),s.style.opacity="1",g(s,"l-loading-bar--start")})}function p(t,e){const l=t.tagName==="BODY"?"body":".l-loading",s=d(`${l} > .l-loading-mask`,t),n=d(`${l} > .l-loading-spinner`,t);if(!n)return;function a(){s&&s.remove(),n.remove();const i=["l-loading"];t.tagName==="BODY"&&i.push("l-loading-fullscreen","l-loading-lock"),t.classList.remove(...i)}n.addEventListener("transitionend",a,{once:!0}),requestAnimationFrame(()=>{s&&(s.style.opacity="0"),g(n,"l-loading-bar--finish"),n.style.opacity="0"})}class k{constructor(e){o(this,"el");o(this,"option");o(this,"isLoading",!1);this.option={fullscreen:!0,lock:!0,shape:"circle",text:"加载中……",background:"",color:"",mask:2,...e};const l=(e||{}).to;let s=null;l!=null&&(typeof l=="string"?s=document.querySelector(l):s=l),(s==null||this.option.fullscreen)&&(s=document.body),this.el=s,this.show()}show(){this.isLoading=!0,h(this.el,this.option)}hide(){this.isLoading=!1,p(this.el,this.option)}destroy(){this.hide(),this.el=void 0}}function c(t){const e=t.getAttribute("l-loading-text"),l=t.getAttribute("l-loading-lock");return{background:t.getAttribute("l-loading-background"),text:e?e==="0"||e==="false"?void 0:e:"加载中……",fullscreen:t.hasAttribute("l-loading-fullscreen"),lock:!(l==="0"||l==="false"),mask:Number(t.hasAttribute("l-loading-mask")||2),shape:t.getAttribute("l-loading-shape")||"circle",color:t.getAttribute("l-loading-color")}}const x={create(t){return new k(t)},init(t){const e=t?`[l-loading="${t}"]`:"[l-loading]",l=u(e);f(l,s=>{const n=c(s);h(n.fullscreen?document.body:s,c(s))})},close(t){const e=t?`[l-loading="${t}"]`:"[l-loading]",l=u(e);f(l,s=>{const n=c(s);p(n.fullscreen?document.body:s,c(s))})}};export{x as L};
